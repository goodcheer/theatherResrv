<!DOCTYPE html>
<html>
<head>

<title>가상세계_매표소</title>

</head>



<body>

<script>
function openRightMenu() {
    var x = document.getElementById("rightMenu");
	x.style.width = "30%";
	x.style.display = "block";
}

function closeRightMenu() {
    document.getElementById("rightMenu").style.display = "none";
}

function deleteReservation(){
	var thisID = sessionStorage.getItem("ID");
	console.log(thisID);
	var resv_info = localStorage.getItem("resv_info");
	resv_info = JSON.parse(resv_info);
	console.log(resv_info)
	i = 0;
	while(i<resv_info.length){
		if (thisID == resv_info[i]["id"]){
			delete resv_info[i]
			}
		i = i+1;
	}
	var new_info = JSON.stringify(resv_info);
	console.log(new_info)
	localStorage.setItem('resv_info',new_info);
}

</script>
<!-- Header -->

  <h1>가상세계 매표소</h1>
  </div>
</header>

<div>
  <hr>
  <div>
    <h2>예약 정보</h2>
  </div>
<div>
<table border="1";>


<tr>
<th>영화 이름</th>
<th>상영 일시</th>
<th>상영 시간(분)</th>
</tr>
<tbody id="info">
</tbody>
</table>
</div>
</div>

<script>

<!-- 예약 내용 확인하고 내용을 출력하겠다 -->
function printReservation(){
		var flag = false;
		var resv_info = localStorage.getItem("resv_info");
		resv_info = JSON.parse(resv_info);
		var thisID = sessionStorage.getItem("ID");

		for (i=0; i < resv_info.length; i++){
			if (thisID == resv_info[i]["id"]){
				var flag = true;
				var str = '<tr><td>'+resv_info[i]["movie_name"]+'</td>'
				+'<td>'+resv_info[i]["date"]+'</td>'
				+'<td>'+resv_info[i]["run_time"]+'</td>';
				document.getElementById("info").innerHTML = str;
	  }
			}
		console.log(flag)
		if (flag == false){
			var str = '<tr><td>null</td>'
				+'<td>null</td>'
				+'<td>null</td>';
			document.getElementById("info").innerHTML = str;
		}
	}
printReservation();
</script>

<div>
  <br>
  <button onclick="deleteReservation()">예약취소</button>
  <!--localStorage.removeItem(key)를 쓰면 특정 key value만 삭제. 지금은 전체 삭제함-->
  <br><br>
</div>
<br>

</div>
<p></p><p></p>

</body>
</html>